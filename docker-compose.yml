version: '3.8'

services:
  mongodb:
    image: mongo:5.0.15-focal
    networks:
      - lila-network
    ports:
      - 27017:27017

  redis:
    image: redis:alpine
    networks:
      - lila-network
    ports:
      - 6379:6379

  lila:
    build:
      context: .
      dockerfile: lila.Dockerfile
    networks:
      - lila-network
    ports:
      - 9663:9663
    volumes:
      - ./lila:/lila
      - ./lila.conf:/lila/conf/application.conf
    depends_on:
      - mongodb
      - redis

  lila-ws:
    build:
      context: .
      dockerfile: lila-ws.Dockerfile
    networks:
      - lila-network
    ports:
      - 9664:9664
    volumes:
      - ./lila-ws:/lila-ws
      - ./lila-ws.conf:/lila-ws.conf
    depends_on:
      - mongodb

  lila-engine:
    build:
      context: .
      dockerfile: lila-engine.Dockerfile
    networks:
      - lila-network
    ports:
      - 9666:9666
    volumes:
      - ./lila-engine:/lila-engine

networks:
  lila-network:
    driver: bridge
